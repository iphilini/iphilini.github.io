<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>HELIX: ORBITAL SCROLL</title>
    <script src="https://unpkg.com/three@0.128.0/build/three.min.js"></script>
    <style>
        body { margin: 0; background: #020408; overflow: hidden; font-family: 'Courier New', monospace; }
        #hud { position: absolute; top: 20px; left: 20px; color: #00ffff; pointer-events: none; z-index: 100; }
        #binary { position: absolute; bottom: 20px; right: 20px; color: #00ff00; font-size: 14px; opacity: 0.5; }
        .label { position: absolute; color: #ffcc00; font-size: 12px; pointer-events: none; background: rgba(0,0,0,0.6); padding: 2px 6px; border-radius: 4px; border: 1px solid #ffcc00; }
        #instructions { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); color: #444; font-size: 10px; }
    </style>
</head>
<body>
    <div id="hud">
        <strong style="font-size: 1.2em;">HELIX_OS v1.7</strong><br>
        [SCROLL TO NAVIGATE]<br>
        PHASE: <span id="phase-label">INIT</span>
    </div>
    <div id="binary">000000</div>
    <div id="instructions">USE MOUSE WHEEL TO SWING ON THE SPIRAL</div>
    <div id="label-container"></div>

    <script>
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x02050a);
        scene.fog = new THREE.FogExp2(0x02050a, 0.015); // Додаємо глибину через туман

        const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // --- ПОКРАЩЕНЕ СВІТЛО ---
        scene.add(new THREE.HemisphereLight(0xffffff, 0x000000, 0.5));
        const pointLight = new THREE.PointLight(0x00ffff, 2, 50);
        scene.add(pointLight);

        let timelinePos = 0.5;
        const sdnData = [
            { t: 0.4, name: "STRATEGIC_PLAN" },
            { t: 0.85, name: "DEEP_WORK" },
            { t: 1.2, name: "RECHARGE" },
            { t: 1.9, name: "SYNTHESIS" },
            { t: 2.3, name: "REFLECTION" }
        ];

        function getPos(t) {
            return new THREE.Vector3(Math.cos(t * Math.PI * 2) * 15, t * 25, Math.sin(t * Math.PI * 2) * 15);
        }

        // Спіраль
        const points = [];
        for(let t=0; t<3; t+=0.01) points.push(getPos(t));
        const line = new THREE.Line(new THREE.BufferGeometry().setFromPoints(points), new THREE.LineBasicMaterial({color: 0x00ffff, transparent: true, opacity: 0.2}));
        scene.add(line);

        // Вузли та мітки
        const nodes = sdnData.map(d => {
            const m = new THREE.Mesh(new THREE.IcosahedronGeometry(0.6, 1), new THREE.MeshStandardMaterial({color: 0xffcc00, emissive: 0xffcc00, emissiveIntensity: 0.2}));
            m.position.copy(getPos(d.t));
            scene.add(m);
            const div = document.createElement('div');
            div.className = 'label';
            div.innerHTML = d.name;
            document.getElementById('label-container').appendChild(div);
            return { mesh: m, div: div, t: d.t };
        });

        const anchor = new THREE.Mesh(new THREE.SphereGeometry(1, 32, 32), new THREE.MeshPhongMaterial({color: 0xff0044, emissive: 0xff0044, emissiveIntensity: 0.5}));
        scene.add(anchor);

        // --- КЕРУВАННЯ СКРОЛОМ ---
        window.addEventListener('wheel', (e) => {
            timelinePos += e.deltaY * 0.0005;
            timelinePos = Math.max(0, Math.min(2.9, timelinePos));
        });

        function update() {
            const pos = getPos(timelinePos);
            anchor.position.copy(pos);
            pointLight.position.copy(pos);
            document.getElementById('binary').innerText = Math.floor(timelinePos * 1024).toString(2).padStart(12, '0');

            nodes.forEach(n => {
                const screenPos = n.mesh.position.clone().project(camera);
                n.div.style.left = `${(screenPos.x + 1) * window.innerWidth / 2}px`;
                n.div.style.top = `${(-screenPos.y + 1) * window.innerHeight / 2}px`;
                const dist = pos.distanceTo(n.mesh.position);
                n.div.style.opacity = dist < 12 ? 1 : 0;
                n.mesh.scale.setScalar(dist < 5 ? 1.5 : 1);
                if(dist < 3) document.getElementById('phase-label').innerText = n.div.innerText;
            });

            camera.position.lerp(new THREE.Vector3(pos.x + 30, pos.y + 10, pos.z + 30), 0.05);
            camera.lookAt(pos);
        }

        function animate() {
            requestAnimationFrame(animate);
            update();
            renderer.render(scene, camera);
        }
        animate();
    </script>
</body>
</html>
